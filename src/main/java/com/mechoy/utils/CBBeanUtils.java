package com.mechoy.utils;

import java.io.File;
import java.net.URL;
import java.net.URLClassLoader;
import java.util.Comparator;

public class CBBeanUtils {
    public static URL BEANUTILS_1_8_3_JAR = null;
    public static URL BEANUTILS_1_9_2_JAR = null;


    public static Object getBeanComparatorInstance(boolean useVersion1_8_3, String property, Comparator comparator) throws Exception {
        if (BEANUTILS_1_8_3_JAR == null) {
            BEANUTILS_1_8_3_JAR = new File("extraLib/commons-beanutils-1.8.3.jar").toURI().toURL();
//            System.out.println(CBBeanUtils.BEANUTILS_1_8_3_JAR);
        }
        if (BEANUTILS_1_9_2_JAR == null) {
            BEANUTILS_1_9_2_JAR = new File("extraLib/commons-beanutils-1.9.2.jar").toURI().toURL();
//            System.out.println(BEANUTILS_1_9_2_JAR.getFile());
        }

        ClassLoader loader = useVersion1_8_3 ? new URLClassLoader(new URL[]{BEANUTILS_1_8_3_JAR})
                : new URLClassLoader(new URL[]{BEANUTILS_1_9_2_JAR});
        Class<?> beanComparatorClass = loader.loadClass("org.apache.commons.beanutils.BeanComparator");
        return beanComparatorClass.getConstructor(String.class, Comparator.class).newInstance(property, comparator);
    }
}
